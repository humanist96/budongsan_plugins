# 튜터리얼 7: 투자 포트폴리오 관리 자동화

## 개요

- **목적:** Google Sheets와 Notion을 활용하여 부동산 투자 포트폴리오를 체계적으로 관리하고, 시가 자동 업데이트 및 수익률 트래킹을 자동화합니다.
- **대상 독자:** 여러 부동산을 보유하거나 관심 매물을 체계적으로 관리하고 싶은 투자자
- **소요 시간:** 약 60-70분
- **난이도:** 중급
- **사용 플러그인:** mcp-google-workspace, mcp-notion, mcp-kr-realestate

### 이 튜터리얼에서 배우는 것

1. Google Sheets에 포트폴리오 전용 템플릿을 설계하고 자동화하는 방법
2. 보유 자산의 실거래가 기반 시세를 자동으로 업데이트하는 방법
3. 자산별/전체 수익률을 체계적으로 계산하는 방법
4. Notion 대시보드로 포트폴리오를 시각적으로 관리하는 방법
5. 리밸런싱 알림과 정기 리포트를 자동 생성하는 방법

---

## 사전 준비

### 1. Google Workspace 설정

Google Sheets API를 사용하려면 Google Cloud Console에서 프로젝트를 생성하고 인증을 설정해야 합니다.

**Google Cloud Console 프로젝트 생성:**

1. [Google Cloud Console](https://console.cloud.google.com)에 접속합니다.
2. 상단의 프로젝트 선택 드롭다운에서 "새 프로젝트"를 클릭합니다.
3. 프로젝트 이름을 `budongsan-portfolio`로 설정하고 "만들기"를 클릭합니다.

**Sheets API 활성화:**

1. 좌측 메뉴에서 "API 및 서비스" > "라이브러리"를 선택합니다.
2. "Google Sheets API"를 검색하여 "사용" 버튼을 클릭합니다.
3. 추가로 "Google Drive API"도 활성화합니다.

**OAuth 2.0 인증 설정:**

1. "API 및 서비스" > "사용자 인증 정보"로 이동합니다.
2. "사용자 인증 정보 만들기" > "OAuth 클라이언트 ID"를 선택합니다.
3. 애플리케이션 유형을 "데스크톱 앱"으로 설정합니다.
4. 생성된 클라이언트 ID와 시크릿을 안전하게 보관합니다.

**MCP 서버 설정:**

`~/.claude.json` 또는 프로젝트의 `.mcp.json` 파일에 다음 설정을 추가합니다.

```json
{
  "mcpServers": {
    "google-workspace": {
      "command": "npx",
      "args": ["-y", "@anthropic/mcp-google-workspace"],
      "env": {
        "GOOGLE_CLIENT_ID": "${GOOGLE_CLIENT_ID}",
        "GOOGLE_CLIENT_SECRET": "${GOOGLE_CLIENT_SECRET}",
        "GOOGLE_REFRESH_TOKEN": "${GOOGLE_REFRESH_TOKEN}"
      }
    }
  }
}
```

환경변수는 `.env` 파일 또는 시스템 환경변수로 관리합니다.

```bash
# .env 파일 (절대로 Git에 커밋하지 마세요)
GOOGLE_CLIENT_ID=your-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-client-secret
GOOGLE_REFRESH_TOKEN=your-refresh-token
```

### 2. Notion 설정 (선택)

Notion을 대시보드로 활용하려면 통합(Integration)을 생성해야 합니다.

**Notion 통합 생성:**

1. [Notion Developers](https://www.notion.so/my-integrations)에 접속합니다.
2. "새 통합 만들기"를 클릭합니다.
3. 통합 이름을 `부동산 포트폴리오`로 설정합니다.
4. 관련 워크스페이스를 선택하고 "제출"을 클릭합니다.
5. 생성된 API 토큰(시크릿)을 복사하여 안전하게 보관합니다.

**작업할 페이지에 통합 연결:**

1. Notion에서 포트폴리오 관리용 페이지를 생성합니다.
2. 페이지 우측 상단 "..." 메뉴 > "연결 추가"에서 방금 만든 통합을 선택합니다.

**MCP 서버 설정:**

```json
{
  "mcpServers": {
    "notion": {
      "command": "npx",
      "args": ["-y", "@anthropic/mcp-notion"],
      "env": {
        "NOTION_API_TOKEN": "${NOTION_API_TOKEN}"
      }
    }
  }
}
```

### 3. mcp-kr-realestate 설정

실거래가 조회를 위한 mcp-kr-realestate 설정은 [튜터리얼 1](./튜터리얼1_아파트_실거래가_조회_및_시세분석.md)을 참조하세요. 공공데이터포털 API 키가 필요합니다.

```json
{
  "mcpServers": {
    "kr-realestate": {
      "command": "npx",
      "args": ["-y", "mcp-kr-realestate"],
      "env": {
        "DATA_GO_KR_API_KEY": "${DATA_GO_KR_API_KEY}"
      }
    }
  }
}
```

---

## Step 1: 포트폴리오 DB 스키마 설계

포트폴리오를 체계적으로 관리하려면 먼저 데이터 구조를 잘 설계해야 합니다.

### 필수 필드 정의

부동산 투자 포트폴리오에 필요한 핵심 필드는 다음과 같습니다.

| 필드명 | 타입 | 설명 | 예시 |
|--------|------|------|------|
| 자산명 | 텍스트 | 아파트 단지명 | 은마아파트 |
| 위치 | 텍스트 | 구/동 주소 | 강남구 대치동 |
| 전용면적 | 숫자 | 전용면적(㎡) | 76 |
| 매수일 | 날짜 | 매수 계약일 | 2022-03-15 |
| 매수가 | 숫자 | 매수 금액(만원) | 250000 |
| 현재시세 | 숫자 | 최신 추정 시세(만원) | 268000 |
| 임대유형 | 선택 | 전세/월세/공실 | 전세 |
| 보증금 | 숫자 | 전세금 또는 월세 보증금(만원) | 140000 |
| 월세 | 숫자 | 월 임대료(만원) | 0 |
| 대출잔액 | 숫자 | 남은 대출금(만원) | 50000 |
| 대출금리 | 숫자 | 연 이자율(%) | 4.2 |
| 시세차익 | 수식 | 현재시세 - 매수가 | 18000 |
| 투자원금 | 수식 | 매수가 - 보증금 - 대출 | 60000 |
| 수익률 | 수식 | 총수익 / 투자원금 | 30.0% |
| 시세업데이트일 | 날짜 | 마지막 시세 업데이트 | 2026-02-18 |
| 상태 | 선택 | 보유/매도예정/매도완료/관심 | 보유 |

### Google Sheets 템플릿 생성

Claude Code에 다음과 같이 요청합니다.

```
부동산 포트폴리오 관리용 Google Sheets 템플릿을 만들어줘.
다음 시트를 포함해야 해:
1. "포트폴리오 현황" - 보유 자산 목록과 현재 상태
2. "수익률 분석" - 자산별, 전체 수익률 계산
3. "현금흐름" - 월별 임대수입과 지출
4. "시세 이력" - 월별 시세 변동 기록
5. "관심 매물" - 투자 후보 추적 목록
```

**예상 결과 - "포트폴리오 현황" 시트 구조:**

```
┌──────────────────────────────────────────────────────────────────────────────────────┐
│  A          B          C      D         E         F        G       H       I        │
├──────────────────────────────────────────────────────────────────────────────────────┤
│1 자산명      위치       면적   매수일     매수가    현재시세   임대유형  보증금   월세      │
│2 은마아파트   강남 대치동  76   2022-03   250,000  268,000   전세    140,000   0       │
│3 마포래미안   마포 아현동  84   2023-06   160,000  175,000   월세     30,000  150     │
│4 옥수파크힐스 성동 옥수동  59   2024-01   120,000  128,000   전세     80,000   0       │
├──────────────────────────────────────────────────────────────────────────────────────┤
│  J          K          L          M          N           O                          │
├──────────────────────────────────────────────────────────────────────────────────────┤
│1 대출잔액    대출금리    시세차익    투자원금    수익률      시세업데이트일              │
│2 50,000     4.2%      18,000     60,000     30.0%      2026-02-18                  │
│3 70,000     4.5%      15,000     60,000     25.0%      2026-02-18                  │
│4 30,000     3.8%       8,000     10,000     80.0%      2026-02-18                  │
└──────────────────────────────────────────────────────────────────────────────────────┘
```

### Notion 데이터베이스 속성 설계

Notion에서는 다음 속성을 가진 데이터베이스를 생성합니다.

| 속성명 | 속성 타입 | 비고 |
|--------|----------|------|
| 자산명 | 제목(Title) | 기본 속성 |
| 위치 | 텍스트 | 구/동 주소 |
| 전용면적(㎡) | 숫자 | 소수점 1자리 |
| 매수일 | 날짜 | 년-월-일 |
| 매수가(만원) | 숫자 | 천 단위 구분 |
| 현재시세(만원) | 숫자 | 천 단위 구분 |
| 수익률(%) | 수식 | 자동 계산 |
| 상태 | 선택(Select) | 보유/매도예정/관심/매도완료 |
| 임대유형 | 선택(Select) | 전세/월세/공실 |
| 메모 | 리치 텍스트 | 투자 판단 근거 등 |

---

## Step 2: 보유 자산 등록

### 프롬프트 입력

Claude Code에 다음과 같이 보유 자산 정보를 전달합니다.

```
내 보유 부동산을 포트폴리오에 등록해줘.

1. 강남구 대치동 은마아파트 76㎡
   - 매수일: 2022년 3월
   - 매수가: 25억
   - 임대: 전세 14억
   - 대출: 잔액 5억, 금리 연 4.2%

2. 마포구 아현동 마포래미안푸르지오 84㎡
   - 매수일: 2023년 6월
   - 매수가: 16억
   - 임대: 월세 보증금 3억 / 월 150만원
   - 대출: 잔액 7억, 금리 연 4.5%

3. 성동구 옥수동 옥수파크힐스 59㎡
   - 매수일: 2024년 1월
   - 매수가: 12억
   - 임대: 전세 8억
   - 대출: 잔액 3억, 금리 연 3.8%

Google Sheets 스프레드시트 ID: 1AbCdEfGhIjKlMnOpQrStUvWxYz (예시)
```

### 데이터 입력 및 검증

Claude Code는 Google Sheets API를 통해 각 자산 정보를 스프레드시트에 입력합니다.

**실행되는 주요 작업:**

1. 스프레드시트의 "포트폴리오 현황" 시트에 3개 자산 데이터 입력
2. 수식 셀 자동 설정 (시세차익, 투자원금, 수익률)
3. 셀 서식 적용 (금액: 천 단위 구분, 수익률: 백분율)
4. 데이터 유효성 검증 (음수 금액 없는지, 날짜 형식 확인)

**예상 응답:**

```
포트폴리오에 3개 자산을 등록했습니다.

[자산 등록 결과]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1. 은마아파트 (강남구 대치동, 76㎡)
   - 매수가: 25억 원 | 전세: 14억 원 | 대출: 5억 원
   - 투자원금(자기자본): 6억 원
   ✓ 등록 완료

2. 마포래미안푸르지오 (마포구 아현동, 84㎡)
   - 매수가: 16억 원 | 보증금: 3억 원 / 월세 150만 원 | 대출: 7억 원
   - 투자원금(자기자본): 6억 원
   ✓ 등록 완료

3. 옥수파크힐스 (성동구 옥수동, 59㎡)
   - 매수가: 12억 원 | 전세: 8억 원 | 대출: 3억 원
   - 투자원금(자기자본): 1억 원
   ✓ 등록 완료

[포트폴리오 요약]
- 총 자산 수: 3건
- 총 매수금액: 53억 원
- 총 투자원금(자기자본): 13억 원
- 총 대출잔액: 15억 원

수식 셀과 서식이 자동으로 설정되었습니다.
현재시세는 Step 3에서 실거래가 기반으로 업데이트됩니다.
```

### 투자원금 계산 방식

각 자산의 투자원금(자기자본)은 다음과 같이 계산됩니다.

```
투자원금 = 매수가 - 보증금(전세금) - 대출금

은마아파트:     25억 - 14억 - 5억 = 6억
마포래미안:     16억 - 3억 - 7억  = 6억
옥수파크힐스:   12억 - 8억 - 3억  = 1억
```

---

## Step 3: 시가 자동 업데이트

### mcp-kr-realestate 연동

보유 자산의 현재 시세를 실거래가 데이터 기반으로 업데이트합니다.

### 프롬프트 입력

```
포트폴리오의 모든 자산에 대해 최신 실거래가 기반 시세를 업데이트해줘.
각 아파트의 최근 6개월 실거래 내역을 조회하고,
동일 면적대의 최근 거래가 평균으로 현재 시세를 추정해줘.
```

### 시세 추정 로직

Claude Code는 다음 절차로 시세를 추정합니다.

**1단계: 실거래가 조회**

각 아파트에 대해 mcp-kr-realestate 플러그인으로 최근 6개월 실거래 내역을 조회합니다.

```
은마아파트 76㎡ 최근 거래 내역:
- 2026-01: 26.8억 (7층)
- 2025-12: 27.1억 (12층)
- 2025-11: 26.5억 (3층)
- 2025-10: 26.2억 (9층)

마포래미안푸르지오 84㎡ 최근 거래 내역:
- 2026-02: 17.8억 (15층)
- 2025-12: 17.2억 (8층)
- 2025-11: 17.0억 (11층)
- 2025-10: 16.5억 (5층)

옥수파크힐스 59㎡ 최근 거래 내역:
- 2026-01: 13.1억 (10층)
- 2025-12: 12.8억 (6층)
- 2025-11: 12.5억 (14층)
```

**2단계: 시세 추정**

최근 3건의 거래 평균을 기준으로 현재 시세를 추정합니다. 층수, 거래 시점 등을 가중치로 반영합니다.

```
추정 시세 산출:
- 은마아파트:     최근 3건 평균 26.8억 → 추정 시세 26.8억
- 마포래미안:     최근 3건 평균 17.3억 → 추정 시세 17.5억
- 옥수파크힐스:   최근 3건 평균 12.8억 → 추정 시세 12.8억
```

### Google Sheets 자동 반영

```
[시세 업데이트 결과]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
자산명           매수가    현재시세    시세차익    변동률
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
은마아파트       25.0억    26.8억    +1.8억    +7.2%
마포래미안       16.0억    17.5억    +1.5억    +9.4%
옥수파크힐스     12.0억    12.8억    +0.8억    +6.7%
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
합계             53.0억    57.1억    +4.1억    +7.7%

업데이트 일시: 2026-02-18 14:30:00
참조 데이터: 국토교통부 실거래가 공개시스템
```

### 시세 이력 관리

"시세 이력" 시트에 월별 시세 스냅샷이 자동으로 기록됩니다.

```
┌──────────────────────────────────────────────────────────────┐
│  날짜        은마아파트   마포래미안    옥수파크힐스   합계      │
├──────────────────────────────────────────────────────────────┤
│  2025-09    25.5억      16.2억      12.1억       53.8억     │
│  2025-10    25.8억      16.5억      12.2억       54.5억     │
│  2025-11    26.0억      17.0억      12.5억       55.5억     │
│  2025-12    26.3억      17.2억      12.8억       56.3억     │
│  2026-01    26.5억      17.3억      12.8억       56.6억     │
│  2026-02    26.8억      17.5억      12.8억       57.1억     │
└──────────────────────────────────────────────────────────────┘
```

---

## Step 4: 수익률 자동 계산

### 프롬프트 입력

```
각 자산별, 전체 포트폴리오 수익률을 계산해줘.
시세차익 수익률, 임대수익률, 레버리지 반영 수익률을 각각 보여줘.
대출이자 비용도 반영한 세전/세후 수익률을 계산해줘.
```

### 수익률 계산 항목

**1. 시세차익 수익률 (Capital Gain)**

```
시세차익 = 현재시세 - 매수가
시세차익 수익률(자기자본 기준) = 시세차익 / 투자원금 x 100
```

**2. 임대수익률 (Rental Yield)**

```
[전세의 경우]
연간 임대수익 = 0 (전세금은 보증금으로 활용)
실질 수익 = 전세 레버리지 효과 (매수자금 절감)

[월세의 경우]
연간 임대수익 = 월세 x 12
연간 임대수익률 = 연간 임대수익 / 매수가 x 100
```

**3. 대출이자 비용**

```
연간 이자비용 = 대출잔액 x 대출금리
```

**4. 종합 수익률**

```
총수익 = 시세차익 + 누적 임대수익 - 누적 대출이자
종합 수익률 = 총수익 / 투자원금 x 100
연환산 수익률(CAGR) = (현재가치/투자원금)^(1/보유기간) - 1
```

### 자산별 수익률 계산 결과

```
[자산별 수익률 분석]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. 은마아파트 (강남구 대치동 76㎡)
   ─────────────────────────────────
   매수가: 25.0억  |  현재시세: 26.8억  |  보유기간: 3년 11개월

   [투자 구조]
   자기자본: 6.0억  |  전세: 14.0억  |  대출: 5.0억 (금리 4.2%)

   [수익 내역]
   시세차익:           +1.8억
   임대수익(전세):       0원 (전세 레버리지)
   누적 대출이자:      -0.82억 (5억 x 4.2% x 3.9년)
   ─────────────────
   순수익:             +0.98억

   [수익률]
   시세차익 수익률:     +30.0% (자기자본 대비)
   순수익률:           +16.3% (이자 차감 후)
   연환산 수익률:       +3.9%

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

2. 마포래미안푸르지오 (마포구 아현동 84㎡)
   ─────────────────────────────────
   매수가: 16.0억  |  현재시세: 17.5억  |  보유기간: 2년 8개월

   [투자 구조]
   자기자본: 6.0억  |  보증금: 3.0억  |  대출: 7.0억 (금리 4.5%)

   [수익 내역]
   시세차익:           +1.5억
   누적 임대수익:      +0.48억 (150만 x 32개월)
   누적 대출이자:      -0.84억 (7억 x 4.5% x 2.67년)
   ─────────────────
   순수익:             +1.14억

   [수익률]
   시세차익 수익률:     +25.0% (자기자본 대비)
   임대수익률:          +1.1% (매수가 대비 연간)
   순수익률:           +19.0% (전체 비용 반영)
   연환산 수익률:       +6.7%

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

3. 옥수파크힐스 (성동구 옥수동 59㎡)
   ─────────────────────────────────
   매수가: 12.0억  |  현재시세: 12.8억  |  보유기간: 2년 1개월

   [투자 구조]
   자기자본: 1.0억  |  전세: 8.0억  |  대출: 3.0억 (금리 3.8%)

   [수익 내역]
   시세차익:           +0.8억
   임대수익(전세):       0원 (전세 레버리지)
   누적 대출이자:      -0.24억 (3억 x 3.8% x 2.08년)
   ─────────────────
   순수익:             +0.56억

   [수익률]
   시세차익 수익률:     +80.0% (자기자본 대비)
   순수익률:           +56.0% (이자 차감 후)
   연환산 수익률:       +23.7%

   * 레버리지 비율이 높아 수익률이 극대화된 사례
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### 전체 포트폴리오 종합 수익률

```
[전체 포트폴리오 요약]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

총 매수금액:        53.0억 원
총 현재시세:        57.1억 원
총 시세차익:        +4.1억 원 (+7.7%)
총 투자원금:        13.0억 원

누적 임대수익:      +0.48억 원
누적 대출이자:      -1.90억 원
─────────────────────────────
포트폴리오 순수익:   +2.68억 원

포트폴리오 수익률:   +20.6% (총 투자원금 대비)

[자산 비중]
은마아파트:        46.9% (26.8억 / 57.1억)
마포래미안:        30.6% (17.5억 / 57.1억)
옥수파크힐스:      22.4% (12.8억 / 57.1억)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

Google Sheets의 "수익률 분석" 시트에 위 계산 결과가 자동으로 반영됩니다.

---

## Step 5: Notion 대시보드 구축 (선택)

Google Sheets에 데이터가 정리되었으면, Notion으로 시각적인 대시보드를 구축할 수 있습니다.

### 프롬프트 입력

```
포트폴리오 현황을 Notion 대시보드로 구축해줘.
다음 내용을 포함해야 해:
1. 보유 자산 데이터베이스 (현재 Google Sheets에 있는 3개 자산)
2. 포트폴리오 요약 정보
3. 보드 뷰 (상태별 분류)
4. 갤러리 뷰 (자산 카드 형태)
```

### Notion 데이터베이스 자동 생성

Claude Code는 mcp-notion 플러그인을 통해 다음 작업을 수행합니다.

**1단계: 데이터베이스 생성**

지정된 페이지 아래에 "부동산 포트폴리오" 데이터베이스를 생성합니다.

```
속성 구성:
- 자산명 (제목)
- 위치 (텍스트)
- 전용면적 (숫자, ㎡)
- 매수가 (숫자, 만원)
- 현재시세 (숫자, 만원)
- 시세차익 (수식: 현재시세 - 매수가)
- 수익률 (수식: round(시세차익 / 매수가 * 100, 1))
- 임대유형 (선택: 전세 / 월세 / 공실)
- 상태 (선택: 보유 / 매도예정 / 관심 / 매도완료)
- 메모 (리치 텍스트)
- 최종 업데이트 (날짜)
```

**2단계: 데이터 입력**

Google Sheets의 포트폴리오 데이터를 Notion 데이터베이스에 동기화합니다.

**3단계: 뷰 설정**

- **테이블 뷰(기본):** 전체 자산 목록을 한눈에 확인
- **보드 뷰:** 상태(보유/매도예정/관심)별로 카드 분류
- **갤러리 뷰:** 각 자산을 카드 형태로 표시 (자산명, 위치, 수익률 표시)

### 예상 결과

```
[Notion 대시보드 구축 완료]

페이지: "부동산 포트폴리오 대시보드"
데이터베이스 ID: abc123-def456-...

등록된 자산:
┌─────────────────────────────────────────────────────────┐
│  [보유]                                                  │
│                                                          │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐   │
│  │ 은마아파트     │  │ 마포래미안    │  │ 옥수파크힐스  │   │
│  │ 강남구 대치동  │  │ 마포구 아현동  │  │ 성동구 옥수동 │   │
│  │ 76㎡         │  │ 84㎡         │  │ 59㎡         │   │
│  │              │  │              │  │              │   │
│  │ 시세: 26.8억  │  │ 시세: 17.5억  │  │ 시세: 12.8억  │   │
│  │ 수익률: +7.2% │  │ 수익률: +9.4% │  │ 수익률: +6.7% │   │
│  └──────────────┘  └──────────────┘  └──────────────┘   │
│                                                          │
│  [매도예정]      [관심]       [매도완료]                    │
│  (비어있음)      (비어있음)    (비어있음)                    │
└─────────────────────────────────────────────────────────┘

3개의 뷰가 생성되었습니다: 테이블, 보드, 갤러리
```

---

## Step 6: 리밸런싱 알림 설정

포트폴리오 내 자산 비중이 목표 범위를 벗어나면 자동으로 알려주는 기능을 설정합니다.

### 프롬프트 입력

```
포트폴리오 내 자산 비중이 설정 범위를 벗어나면 알려줘.

목표 비중:
- 강남 권역 (은마아파트): 40% (허용 범위: 35-45%)
- 마포 권역 (마포래미안): 35% (허용 범위: 30-40%)
- 성동 권역 (옥수파크힐스): 25% (허용 범위: 20-30%)

현재 시세 기준으로 비중을 분석하고, 리밸런싱이 필요하면 구체적으로 제안해줘.
```

### 비중 분석 결과

```
[포트폴리오 비중 분석]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

자산            현재시세    현재비중    목표비중    허용범위     상태
─────────────────────────────────────────────────────────
은마아파트       26.8억     46.9%      40%       35-45%     ⚠ 초과
마포래미안       17.5억     30.6%      35%       30-40%     정상
옥수파크힐스     12.8억     22.4%      25%       20-30%     정상
─────────────────────────────────────────────────────────
합계            57.1억     100%

[리밸런싱 알림]
⚠ 은마아파트 비중이 46.9%로 허용 상한(45%)을 1.9%p 초과했습니다.

[리밸런싱 제안]
목표 비중(40%)에 맞추려면:
- 은마아파트 비중을 약 3.9억 원 줄이거나
- 마포/성동 권역에 추가 투자 필요

구체적 방안:
1. 은마아파트 일부 매도 후 성동/마포 권역 추가 매수
2. 성동 권역에 2-3억 원 규모 추가 투자로 비중 조정
3. 현 상태 유지 (허용 범위 근접이므로 시장 변동 관찰)

→ 시세 변동에 따라 자연 조정 가능성이 있으므로,
  당장의 리밸런싱보다는 다음 분기까지 관찰을 권장합니다.
```

### Google Sheets 리밸런싱 시트

"포트폴리오 현황" 시트에 목표 비중과 허용 범위를 설정하는 영역을 추가합니다.

```
┌────────────────────────────────────────────────────────────────┐
│  [리밸런싱 설정]                                                │
│                                                                │
│  자산            목표비중    하한    상한    현재비중    상태      │
│  은마아파트       40%       35%    45%    46.9%     ⚠ 초과     │
│  마포래미안       35%       30%    40%    30.6%     정상       │
│  옥수파크힐스     25%       20%    30%    22.4%     정상       │
│                                                                │
│  * 조건부 서식: 허용 범위 초과 시 빨간색 배경 자동 적용           │
└────────────────────────────────────────────────────────────────┘
```

---

## Step 7: 정기 리포트 자동 생성

### 프롬프트 입력

```
월간 포트폴리오 현황 리포트를 생성해줘.
2026년 2월 기준으로 작성하고, Google Sheets에 월별 스냅샷도 저장해줘.
```

### 월간 리포트 생성 결과

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    부동산 투자 포트폴리오 월간 리포트
    2026년 2월
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. 포트폴리오 총괄
───────────────────────────────────────────────────
총 자산가치:        57.1억 원
전월 대비 변동:     +0.5억 원 (+0.88%)
총 매수금액:        53.0억 원
총 시세차익:        +4.1억 원 (+7.74%)

2. 자산별 성과
───────────────────────────────────────────────────
                  전월시세  금월시세  변동    변동률
은마아파트         26.5억   26.8억  +0.3억  +1.1%
마포래미안         17.3억   17.5억  +0.2억  +1.2%
옥수파크힐스       12.8억   12.8억   0      0.0%

최고 성과: 마포래미안 (+1.2%)
최저 성과: 옥수파크힐스 (0.0%)

3. 월간 현금흐름
───────────────────────────────────────────────────
[수입]
마포래미안 월세:                    +150만 원

[지출]
은마아파트 대출이자 (5억 x 4.2%/12):  -175만 원
마포래미안 대출이자 (7억 x 4.5%/12):  -263만 원
옥수파크힐스 대출이자 (3억 x 3.8%/12): -95만 원
───────────────────────────────────────────────────
월간 순현금흐름:                    -383만 원

* 전세 자산은 전세금 운용 수익 미반영 상태

4. 포트폴리오 비중
───────────────────────────────────────────────────
은마아파트:      46.9% (목표 40%) ⚠ 상한 초과
마포래미안:      30.6% (목표 35%)
옥수파크힐스:    22.4% (목표 25%)

5. 리밸런싱 필요 여부
───────────────────────────────────────────────────
은마아파트 비중이 허용 상한(45%)을 초과했으나,
초과 폭(1.9%p)이 크지 않아 관찰 지속 권장.

6. 주요 시장 이벤트
───────────────────────────────────────────────────
- 강남구 실거래가 전월 대비 소폭 상승세 유지
- 마포구 신축 아파트 입주 물량 영향으로 가격 상승 둔화 가능성
- 금리 동결 기조 지속으로 대출 부담 변동 없음

7. 다음 달 체크리스트
───────────────────────────────────────────────────
□ 은마아파트 전세 만기 확인 (2026년 3월 예정)
□ 금리 변동 모니터링
□ 옥수파크힐스 주변 개발 호재 확인
□ 포트폴리오 리밸런싱 재검토

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
리포트 생성일: 2026-02-18
다음 리포트 예정일: 2026-03-18
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### 월별 스냅샷 저장

Google Sheets의 "시세 이력" 시트에 월별 스냅샷이 자동으로 추가됩니다. 이를 통해 시간에 따른 자산가치 변동을 추적할 수 있습니다.

### 자동 실행 설정 팁

매월 정기적으로 리포트를 생성하려면, Claude Code 커스텀 명령어를 활용할 수 있습니다.

```bash
# ~/.claude/commands/monthly-portfolio-report.md
포트폴리오 월간 리포트를 생성해줘.
1. 모든 자산의 최신 시세를 업데이트
2. 수익률을 재계산
3. Google Sheets에 월별 스냅샷 저장
4. 월간 리포트 생성
5. Notion 대시보드 업데이트
```

이후 Claude Code에서 `/monthly-portfolio-report`로 간편하게 실행할 수 있습니다.

---

## 실전 응용

### 응용 1: 관심 매물 추적 목록

투자 후보 매물을 별도로 관리하고, 시세 변동을 지속적으로 추적합니다.

```
관심 매물 추적 목록을 만들어줘.

1. 송파구 잠실동 잠실엘스 84㎡ - 현재 호가 23억, 목표 매수가 22억
2. 용산구 한남동 한남더힐 120㎡ - 현재 호가 45억, 목표 매수가 42억
3. 서초구 반포동 아크로리버파크 84㎡ - 현재 호가 38억, 목표 매수가 35억

각 매물의 시세 변동을 매주 업데이트하고,
목표 매수가에 도달하면 알려줘.
```

**예상 결과:**

Google Sheets의 "관심 매물" 시트에 다음과 같이 등록됩니다.

```
┌──────────────────────────────────────────────────────────────────────┐
│  자산명          위치        면적   현재호가   목표매수가  괴리율   상태  │
├──────────────────────────────────────────────────────────────────────┤
│  잠실엘스        송파 잠실동   84    23.0억    22.0억    -4.3%   관찰  │
│  한남더힐        용산 한남동   120   45.0억    42.0억    -6.7%   관찰  │
│  아크로리버파크   서초 반포동   84    38.0억    35.0억    -7.9%   관찰  │
└──────────────────────────────────────────────────────────────────────┘
```

### 응용 2: 현금흐름 관리

월별 임대수입, 대출이자, 세금 지출을 종합적으로 관리합니다.

```
월간 현금흐름 관리 시트를 만들어줘.
모든 보유 자산의 수입과 지출을 월별로 정리하고,
연간 현금흐름 예측도 해줘.
```

**예상 결과 - 월간 현금흐름 시트:**

```
┌──────────────────────────────────────────────────────────────────┐
│  2026년 월간 현금흐름                                             │
├──────────────────────────────────────────────────────────────────┤
│  항목                              1월      2월    ...   12월    │
├──────────────────────────────────────────────────────────────────┤
│  [수입]                                                          │
│  마포래미안 월세                    150     150    ...   150     │
│  수입 소계                         150     150    ...   150     │
├──────────────────────────────────────────────────────────────────┤
│  [지출]                                                          │
│  은마 대출이자 (5억 x 4.2%)        175     175    ...   175     │
│  마포 대출이자 (7억 x 4.5%)        263     263    ...   263     │
│  옥수 대출이자 (3억 x 3.8%)         95      95    ...    95     │
│  재산세 (7월)                        0       0    ...     0     │
│  종합부동산세 (12월)                  0       0    ...  해당시   │
│  지출 소계                         533     533    ...   533     │
├──────────────────────────────────────────────────────────────────┤
│  월간 순현금흐름                   -383    -383    ...  -383    │
│  누적 현금흐름                     -383    -766    ...  -4,596  │
└──────────────────────────────────────────────────────────────────┘
                                                     (단위: 만 원)

연간 현금흐름 요약:
- 연간 임대수입:     +1,800만 원
- 연간 대출이자:     -6,396만 원
- 연간 순현금흐름:   -4,596만 원 (월 평균 -383만 원)

* 전세 만기 시 전세금 변동에 따라 현금흐름 변동 가능
```

### 응용 3: 세금 시뮬레이션

매도 시점의 양도소득세를 미리 시뮬레이션하여 최적의 매도 시기를 판단합니다.

```
은마아파트를 지금 매도한다고 가정하고 양도세를 시뮬레이션해줘.
- 매수가: 25억
- 예상 매도가: 26.8억
- 보유기간: 3년 11개월
- 1세대 1주택 여부: 아니오 (다주택자)
```

양도세 시뮬레이션의 상세 내용은 [튜터리얼 3: 투자수익률 계산 및 시뮬레이션](./튜터리얼3_투자수익률_계산_및_시뮬레이션.md)을 참조하세요.

**간략 시뮬레이션 결과:**

```
[양도세 시뮬레이션 - 은마아파트]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
양도차익:            1.8억 원
필요경비:            약 600만 원 (취득세, 중개수수료 등)
과세표준:            약 1.74억 원
적용세율:            다주택 중과세율 적용 (기본세율 + 20%p)
예상 양도세:         약 7,800만 원
지방소득세:          약 780만 원
───────────────────────────────────────
세후 순수익:         약 9,400만 원

* 실제 세금은 개인 상황에 따라 달라질 수 있습니다.
  세무사와 상담을 권장합니다.
```

---

## 보안 주의사항

부동산 포트폴리오에는 민감한 금융 정보가 포함되므로 보안에 각별히 주의해야 합니다.

### API 키 관리

```bash
# 올바른 방법: 환경변수로 관리
export GOOGLE_CLIENT_ID="your-client-id"
export GOOGLE_CLIENT_SECRET="your-client-secret"
export NOTION_API_TOKEN="your-notion-token"
export DATA_GO_KR_API_KEY="your-api-key"

# 잘못된 방법: 코드나 설정 파일에 직접 입력 (절대 금지)
# "client_id": "abc123-actual-key-here"
```

`.env` 파일을 사용하는 경우 반드시 `.gitignore`에 추가합니다.

```
# .gitignore
.env
.env.local
*.credentials.json
```

### Google Sheets 공유 설정

- 포트폴리오 스프레드시트의 공유 설정을 "비공개"로 유지합니다.
- 공유가 필요한 경우 특정 Google 계정만 지정하여 공유합니다.
- "링크가 있는 모든 사용자" 공유는 절대 사용하지 않습니다.

### Notion 페이지 보안

- Notion 통합(Integration)의 접근 권한을 필요한 페이지에만 제한합니다.
- 워크스페이스 전체 접근 권한은 부여하지 않습니다.
- 민감한 정보(대출 금액, 금리 등)가 포함된 페이지의 게스트 공유에 주의합니다.

### 일반 보안 수칙

- 정기적으로 API 토큰을 갱신합니다.
- 사용하지 않는 통합은 비활성화합니다.
- 금융 정보가 포함된 데이터의 백업은 암호화하여 보관합니다.
- 공용 네트워크에서의 포트폴리오 데이터 접근을 최소화합니다.

---

## 전체 시리즈 요약

본 튜터리얼은 "Claude Code 부동산 플러그인 활용 가이드" 시리즈의 마지막 편입니다. 아래 표에서 전체 시리즈를 확인할 수 있습니다.

| 튜터리얼 | 핵심 내용 | 사용 플러그인 |
|----------|----------|-------------|
| [1. 실거래가 조회](./튜터리얼1_아파트_실거래가_조회_및_시세분석.md) | 아파트 실거래가 조회 및 시세 분석 | mcp-kr-realestate |
| [2. 매물 크롤링](./튜터리얼2_웹크롤링으로_부동산_매물_탐색.md) | 웹크롤링으로 실시간 매물 탐색 | firecrawl-mcp-server, mcp-fetch |
| [3. 수익률 계산](./튜터리얼3_투자수익률_계산_및_시뮬레이션.md) | 투자수익률 계산 및 시뮬레이션 | mcp-kr-realestate, data:analyze, finance:variance-analysis |
| [4. 거시경제 분석](./튜터리얼4_거시경제_지표와_부동산_상관분석.md) | 거시경제 지표와 부동산 상관분석 | mcp-alphavantage, mcp-kr-realestate, data:statistical-analysis |
| [5. 대시보드](./튜터리얼5_부동산_분석_대시보드_구축.md) | 인터랙티브 분석 대시보드 구축 | data:build-dashboard, data:create-viz, mcp-kr-realestate |
| [6. 지역 비교](./튜터리얼6_지역비교_분석_리포트_자동생성.md) | 지역비교 분석 리포트 자동생성 | mcp-kr-realestate, firecrawl-mcp-server, mcp-perplexity, data:analyze |
| [7. 포트폴리오](./튜터리얼7_투자_포트폴리오_관리_자동화.md) | 포트폴리오 관리 자동화 | mcp-google-workspace, mcp-notion, mcp-kr-realestate |

### 시리즈 학습 경로

```
[입문] 튜터리얼 1 → 실거래가 데이터 이해
         ↓
[탐색] 튜터리얼 2 → 매물 정보 수집 능력 확보
         ↓
[분석] 튜터리얼 3 → 투자 수익률 계산 역량
         ↓
[심화] 튜터리얼 4 → 거시경제 맥락 이해
         ↓
[시각화] 튜터리얼 5 → 데이터 시각화 및 대시보드
         ↓
[비교] 튜터리얼 6 → 지역 간 비교 분석
         ↓
[통합] 튜터리얼 7 → 전체 워크플로우 자동화 (현재)
```

---

## 다음 단계

본 시리즈를 완료하셨다면, 다음과 같은 방향으로 확장할 수 있습니다.

### 1. 커스텀 Claude Code 명령어 구축

자주 사용하는 분석 작업을 커스텀 명령어로 등록하여 효율성을 높일 수 있습니다.

```bash
# ~/.claude/commands/ 디렉토리에 명령어 파일 생성

# analyze-apt.md - 아파트 분석 원스톱 명령어
# market-report.md - 시장 리포트 자동 생성
# portfolio-update.md - 포트폴리오 일괄 업데이트
```

### 2. 자동화된 시장 모니터링

주간/월간 단위로 시장 동향을 자동으로 모니터링하고 리포트를 받아볼 수 있습니다.

```
매주 월요일 아침에 다음 작업을 수행해줘:
1. 관심 지역(강남, 마포, 성동) 실거래가 변동 확인
2. 보유 자산 시세 업데이트
3. 주간 시장 동향 요약 리포트 생성
4. 특이사항 있을 시 알림
```

### 3. 데이터 기반 투자 의사결정 프레임워크

튜터리얼 1~7의 도구를 조합하여 체계적인 투자 의사결정 프레임워크를 구축할 수 있습니다.

```
투자 의사결정 프로세스:
1단계: 실거래가 분석 (튜터리얼 1) → 적정가 판단
2단계: 매물 탐색 (튜터리얼 2) → 투자 후보 발굴
3단계: 수익률 시뮬레이션 (튜터리얼 3) → 투자 타당성 검증
4단계: 거시경제 확인 (튜터리얼 4) → 매수 타이밍 판단
5단계: 대시보드 확인 (튜터리얼 5) → 종합 현황 파악
6단계: 지역 비교 (튜터리얼 6) → 최적 지역 선정
7단계: 포트폴리오 반영 (튜터리얼 7) → 자산 등록 및 관리
```

---

> **면책 조항:** 본 튜터리얼은 부동산 투자에 대한 조언이 아닌, Claude Code 플러그인 활용 방법을 안내하기 위한 기술 문서입니다. 실제 투자 결정은 반드시 전문가(공인중개사, 세무사, 재무설계사)와 상담 후 진행하시기 바랍니다. 본 문서에 사용된 시세 및 수익률 데이터는 설명을 위한 예시이며, 실제 시장 상황과 다를 수 있습니다.
