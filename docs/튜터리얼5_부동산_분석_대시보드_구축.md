# 튜터리얼 5: 부동산 분석 대시보드 구축

## 개요

- **목적:** Claude Code의 대시보드 빌드 스킬을 활용하여 인터랙티브한 부동산 분석 대시보드를 구축합니다.
- **대상 독자:** 데이터 시각화에 관심 있는 부동산 투자자/분석가
- **소요 시간:** 약 60-70분
- **난이도:** 중급
- **사용 플러그인:** `data:build-dashboard`, `data:create-viz`, `mcp-kr-realestate`

이 튜터리얼에서는 서울시 25개 구의 아파트 실거래 데이터를 기반으로, 핵심 지표 카드부터 인터랙티브 차트까지 포함된 종합 대시보드를 단계적으로 구축합니다. 완성된 대시보드는 HTML 파일 하나로 내보내어 브라우저에서 바로 확인할 수 있습니다.

---

## 사전 준비

### 1. mcp-kr-realestate 설정 확인

`mcp-kr-realestate` 플러그인이 정상적으로 설정되어 있어야 합니다. 아직 설정하지 않았다면 [튜터리얼 1](./튜터리얼1_아파트_실거래가_조회_및_시세분석.md)을 먼저 완료해 주세요.

설정 확인 방법:

```text
> mcp-kr-realestate를 사용해서 강남구 아파트 시세를 조회해줘
```

정상적으로 데이터가 반환되면 준비 완료입니다.

### 2. data 스킬 활성화 확인

Claude Code 마켓플레이스에서 다음 두 가지 스킬이 활성화되어 있는지 확인합니다:

- **data:build-dashboard** - 인터랙티브 HTML 대시보드를 빌드하는 스킬
- **data:create-viz** - 출판 품질의 시각화를 생성하는 스킬

활성화 확인:

```text
> /data:build-dashboard 테스트
> /data:create-viz 테스트
```

각 스킬이 정상적으로 응답하면 준비가 완료된 것입니다.

### 3. 작업 디렉토리 준비

대시보드 파일이 저장될 디렉토리를 미리 만들어 둡니다:

```bash
mkdir -p ~/realestate-dashboard/charts
mkdir -p ~/realestate-dashboard/data
```

---

## 대시보드 구성 요소 설계

최종 완성될 대시보드의 레이아웃을 먼저 설계합니다. 좋은 대시보드는 정보 계층 구조가 명확해야 합니다.

### 대시보드 레이아웃

```text
+------------------------------------------------------------------+
|                    서울 아파트 시장 분석 대시보드                      |
+------------------------------------------------------------------+
| [평균 매매가]  | [전월 대비 변동률] | [월간 거래량] | [평균 전세가율]  |
|   12.3억 원    |     +2.1%        |   4,523건    |    58.7%       |
+------------------------------------------------------------------+
|  지역별 히트맵          |  매매/전세 추이 차트  |  필터 패널        |
|  (구별 색상 표시)       |  (이중축 라인차트)    |  - 지역 선택     |
|                        |                      |  - 면적대 선택    |
|                        |                      |  - 기간 설정      |
+------------------------------------------------------------------+
|              거래 상세 테이블 (정렬/검색 가능)                       |
|  지역 | 단지명 | 면적 | 매매가 | 전세가 | 전세가율 | 변동률        |
+------------------------------------------------------------------+
```

### 구성 요소별 역할

| 구성 요소 | 역할 | 사용 스킬 |
|-----------|------|----------|
| 핵심 지표 카드 | 시장 전체 현황을 한눈에 파악 | `data:build-dashboard` |
| 지역별 히트맵 | 구별 가격 수준 비교 | `data:create-viz` |
| 추이 차트 | 시계열 트렌드 분석 | `data:create-viz` |
| 필터 패널 | 사용자 맞춤 조건 설정 | `data:build-dashboard` |
| 상세 테이블 | 개별 거래 내역 확인 | `data:build-dashboard` |

---

## Step 1: 데이터 수집 및 준비

### 프롬프트

```text
서울시 25개 구의 아파트 평균 매매가와 전세가 데이터를 수집해줘.
각 구별로 평균 매매가, 평균 전세가, 월간 거래량, 전월 대비 변동률을 포함해줘.
```

### 예상 응답 및 데이터 구조

Claude Code가 `mcp-kr-realestate`를 통해 수집한 데이터는 다음과 같은 구조를 갖습니다:

```json
{
  "조회기준": "2026년 1월",
  "데이터": [
    {
      "구": "강남구",
      "평균매매가_만원": 182000,
      "평균전세가_만원": 98000,
      "전세가율": 53.8,
      "월간거래량": 312,
      "전월대비변동률": 1.8
    },
    {
      "구": "서초구",
      "평균매매가_만원": 168000,
      "평균전세가_만원": 91000,
      "전세가율": 54.2,
      "월간거래량": 245,
      "전월대비변동률": 1.5
    }
  ]
}
```

### 서울시 25개 구 샘플 데이터

아래는 대시보드 구축에 사용할 참고 데이터입니다. 실제 실행 시에는 `mcp-kr-realestate`를 통해 최신 데이터가 자동으로 수집됩니다.

| 구 | 평균매매가(만원) | 평균전세가(만원) | 전세가율(%) | 월간거래량 | 변동률(%) |
|---|---|---|---|---|---|
| 강남구 | 182,000 | 98,000 | 53.8 | 312 | +1.8 |
| 서초구 | 168,000 | 91,000 | 54.2 | 245 | +1.5 |
| 송파구 | 142,000 | 78,000 | 54.9 | 387 | +2.1 |
| 용산구 | 155,000 | 82,000 | 52.9 | 178 | +1.2 |
| 성동구 | 118,000 | 68,000 | 57.6 | 203 | +1.9 |
| 광진구 | 105,000 | 62,000 | 59.0 | 167 | +1.1 |
| 마포구 | 112,000 | 65,000 | 58.0 | 256 | +1.7 |
| 영등포구 | 98,000 | 58,000 | 59.2 | 198 | +0.8 |
| 양천구 | 95,000 | 57,000 | 60.0 | 234 | +1.3 |
| 강서구 | 78,000 | 48,000 | 61.5 | 345 | +0.5 |
| 동작구 | 102,000 | 60,000 | 58.8 | 176 | +1.0 |
| 관악구 | 72,000 | 44,000 | 61.1 | 189 | +0.3 |
| 서대문구 | 82,000 | 49,000 | 59.8 | 143 | +0.7 |
| 은평구 | 68,000 | 42,000 | 61.8 | 215 | +0.4 |
| 종로구 | 108,000 | 61,000 | 56.5 | 87 | +0.9 |
| 중구 | 112,000 | 63,000 | 56.3 | 92 | +1.0 |
| 동대문구 | 75,000 | 46,000 | 61.3 | 178 | +0.6 |
| 중랑구 | 62,000 | 39,000 | 62.9 | 201 | +0.2 |
| 성북구 | 72,000 | 44,000 | 61.1 | 165 | -0.1 |
| 강북구 | 52,000 | 33,000 | 63.5 | 134 | -0.3 |
| 도봉구 | 55,000 | 35,000 | 63.6 | 156 | -0.2 |
| 노원구 | 58,000 | 37,000 | 63.8 | 287 | +0.1 |
| 구로구 | 72,000 | 45,000 | 62.5 | 213 | +0.4 |
| 금천구 | 62,000 | 39,000 | 62.9 | 145 | +0.3 |
| 강동구 | 108,000 | 63,000 | 58.3 | 267 | +1.6 |

### 데이터 검증 프롬프트

데이터 수집 후 검증을 수행합니다:

```text
수집된 데이터를 검증해줘.
- 누락된 구가 없는지 확인
- 매매가와 전세가의 비율이 합리적인지 확인 (전세가율 50-70% 범위)
- 이상치가 있는지 확인
```

---

## Step 2: 핵심 지표 카드 생성

### 프롬프트

```text
서울 아파트 시장 핵심 지표를 요약 카드 4개로 만들어줘.
포함할 지표: 평균 매매가, 전월 대비 변동률, 월간 총 거래량, 평균 전세가율
카드에는 아이콘, 수치, 전월 대비 비교를 포함해줘.
```

### KPI 카드 설계

대시보드 상단에 배치될 4개의 핵심 지표(KPI) 카드입니다:

| 카드 | 수치 | 보조 정보 | 색상 |
|------|------|----------|------|
| 평균 매매가 | 9.7억 원 | 서울 25개 구 평균 | 파란색 |
| 전월 대비 변동률 | +0.82% | 전월 대비 상승 | 빨간색 (상승) |
| 월간 거래량 | 5,017건 | 전월 대비 +342건 | 녹색 |
| 평균 전세가율 | 59.1% | 전월 대비 -0.3%p | 주황색 |

### 예상 HTML 코드

`data:build-dashboard` 스킬이 생성하는 KPI 카드 영역의 HTML 구조는 다음과 유사합니다:

```html
<div class="kpi-container">
  <div class="kpi-card">
    <div class="kpi-icon" style="background-color: #3B82F6;">
      <svg><!-- 집 아이콘 --></svg>
    </div>
    <div class="kpi-content">
      <span class="kpi-label">평균 매매가</span>
      <span class="kpi-value">9.7억 원</span>
      <span class="kpi-change positive">전월 대비 +0.82%</span>
    </div>
  </div>

  <div class="kpi-card">
    <div class="kpi-icon" style="background-color: #EF4444;">
      <svg><!-- 차트 아이콘 --></svg>
    </div>
    <div class="kpi-content">
      <span class="kpi-label">전월 대비 변동률</span>
      <span class="kpi-value">+0.82%</span>
      <span class="kpi-change positive">3개월 연속 상승</span>
    </div>
  </div>

  <div class="kpi-card">
    <div class="kpi-icon" style="background-color: #10B981;">
      <svg><!-- 거래 아이콘 --></svg>
    </div>
    <div class="kpi-content">
      <span class="kpi-label">월간 거래량</span>
      <span class="kpi-value">5,017건</span>
      <span class="kpi-change positive">전월 대비 +342건</span>
    </div>
  </div>

  <div class="kpi-card">
    <div class="kpi-icon" style="background-color: #F59E0B;">
      <svg><!-- 비율 아이콘 --></svg>
    </div>
    <div class="kpi-content">
      <span class="kpi-label">평균 전세가율</span>
      <span class="kpi-value">59.1%</span>
      <span class="kpi-change negative">전월 대비 -0.3%p</span>
    </div>
  </div>
</div>
```

### 스타일 코드

```css
.kpi-container {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 20px;
  margin-bottom: 24px;
}

.kpi-card {
  background: white;
  border-radius: 12px;
  padding: 20px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  display: flex;
  align-items: center;
  gap: 16px;
}

.kpi-value {
  font-size: 28px;
  font-weight: 700;
  color: #1E293B;
}

.kpi-change.positive { color: #EF4444; }  /* 한국 관례: 상승 = 빨간색 */
.kpi-change.negative { color: #3B82F6; }  /* 한국 관례: 하락 = 파란색 */
```

---

## Step 3: 지역별 히트맵 생성

### 프롬프트

```text
/data:create-viz
서울시 25개 구별 아파트 평균 매매가를 히트맵으로 시각화해줘.
- 가격이 높을수록 진한 빨간색, 낮을수록 연한 파란색으로 표시
- 각 구 이름과 가격(억 단위)을 히트맵 위에 표시
- 마우스 오버 시 상세 정보(매매가, 전세가, 전세가율, 거래량) 툴팁 표시
- Chart.js 기반으로 만들어줘
```

### 히트맵 구현 방식

서울시 구별 히트맵은 Chart.js의 Matrix 차트 또는 커스텀 캔버스를 활용하여 구현합니다. `data:create-viz` 스킬은 데이터 특성에 맞는 최적의 시각화 방식을 자동으로 선택합니다.

### 예상 JavaScript 코드

```javascript
// 히트맵 데이터 정의
const heatmapData = [
  { gu: '강남구', price: 18.2, jeonse: 9.8, ratio: 53.8, volume: 312, change: 1.8 },
  { gu: '서초구', price: 16.8, jeonse: 9.1, ratio: 54.2, volume: 245, change: 1.5 },
  { gu: '송파구', price: 14.2, jeonse: 7.8, ratio: 54.9, volume: 387, change: 2.1 },
  { gu: '용산구', price: 15.5, jeonse: 8.2, ratio: 52.9, volume: 178, change: 1.2 },
  { gu: '성동구', price: 11.8, jeonse: 6.8, ratio: 57.6, volume: 203, change: 1.9 },
  { gu: '광진구', price: 10.5, jeonse: 6.2, ratio: 59.0, volume: 167, change: 1.1 },
  { gu: '마포구', price: 11.2, jeonse: 6.5, ratio: 58.0, volume: 256, change: 1.7 },
  { gu: '영등포구', price: 9.8, jeonse: 5.8, ratio: 59.2, volume: 198, change: 0.8 },
  { gu: '양천구', price: 9.5, jeonse: 5.7, ratio: 60.0, volume: 234, change: 1.3 },
  { gu: '강서구', price: 7.8, jeonse: 4.8, ratio: 61.5, volume: 345, change: 0.5 },
  { gu: '동작구', price: 10.2, jeonse: 6.0, ratio: 58.8, volume: 176, change: 1.0 },
  { gu: '관악구', price: 7.2, jeonse: 4.4, ratio: 61.1, volume: 189, change: 0.3 },
  { gu: '서대문구', price: 8.2, jeonse: 4.9, ratio: 59.8, volume: 143, change: 0.7 },
  { gu: '은평구', price: 6.8, jeonse: 4.2, ratio: 61.8, volume: 215, change: 0.4 },
  { gu: '종로구', price: 10.8, jeonse: 6.1, ratio: 56.5, volume: 87, change: 0.9 },
  { gu: '중구', price: 11.2, jeonse: 6.3, ratio: 56.3, volume: 92, change: 1.0 },
  { gu: '동대문구', price: 7.5, jeonse: 4.6, ratio: 61.3, volume: 178, change: 0.6 },
  { gu: '중랑구', price: 6.2, jeonse: 3.9, ratio: 62.9, volume: 201, change: 0.2 },
  { gu: '성북구', price: 7.2, jeonse: 4.4, ratio: 61.1, volume: 165, change: -0.1 },
  { gu: '강북구', price: 5.2, jeonse: 3.3, ratio: 63.5, volume: 134, change: -0.3 },
  { gu: '도봉구', price: 5.5, jeonse: 3.5, ratio: 63.6, volume: 156, change: -0.2 },
  { gu: '노원구', price: 5.8, jeonse: 3.7, ratio: 63.8, volume: 287, change: 0.1 },
  { gu: '구로구', price: 7.2, jeonse: 4.5, ratio: 62.5, volume: 213, change: 0.4 },
  { gu: '금천구', price: 6.2, jeonse: 3.9, ratio: 62.9, volume: 145, change: 0.3 },
  { gu: '강동구', price: 10.8, jeonse: 6.3, ratio: 58.3, volume: 267, change: 1.6 }
];

// 가격 범위에 따른 색상 매핑 함수
function getPriceColor(price) {
  const minPrice = 5.0;
  const maxPrice = 18.5;
  const ratio = (price - minPrice) / (maxPrice - minPrice);

  // 파란색(저가) -> 노란색(중간) -> 빨간색(고가) 그라데이션
  const r = Math.round(ratio > 0.5 ? 255 : ratio * 2 * 255);
  const g = Math.round(ratio > 0.5 ? (1 - ratio) * 2 * 255 : 255 * ratio * 1.5);
  const b = Math.round(ratio < 0.5 ? (1 - ratio * 2) * 200 : 0);

  return `rgb(${r}, ${g}, ${b})`;
}

// 히트맵 그리드 렌더링
function renderHeatmap(containerId) {
  const container = document.getElementById(containerId);
  const grid = document.createElement('div');
  grid.className = 'heatmap-grid';

  const sorted = [...heatmapData].sort((a, b) => b.price - a.price);

  sorted.forEach(item => {
    const cell = document.createElement('div');
    cell.className = 'heatmap-cell';
    cell.style.backgroundColor = getPriceColor(item.price);
    cell.innerHTML = `
      <span class="gu-name">${item.gu}</span>
      <span class="gu-price">${item.price}억</span>
    `;

    // 툴팁 이벤트
    cell.addEventListener('mouseenter', (e) => {
      showTooltip(e, item);
    });
    cell.addEventListener('mouseleave', hideTooltip);

    grid.appendChild(cell);
  });

  container.appendChild(grid);
}

// 툴팁 표시
function showTooltip(event, data) {
  const tooltip = document.getElementById('heatmap-tooltip');
  tooltip.innerHTML = `
    <strong>${data.gu}</strong><br>
    매매가: ${data.price}억 원<br>
    전세가: ${data.jeonse}억 원<br>
    전세가율: ${data.ratio}%<br>
    거래량: ${data.volume}건<br>
    변동률: ${data.change > 0 ? '+' : ''}${data.change}%
  `;
  tooltip.style.display = 'block';
  tooltip.style.left = event.pageX + 12 + 'px';
  tooltip.style.top = event.pageY + 12 + 'px';
}
```

### 히트맵 스타일

```css
.heatmap-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 8px;
  padding: 16px;
}

.heatmap-cell {
  padding: 16px 12px;
  border-radius: 8px;
  text-align: center;
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
}

.heatmap-cell:hover {
  transform: scale(1.05);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
}

.gu-name {
  display: block;
  font-size: 14px;
  font-weight: 600;
  color: white;
  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
}

.gu-price {
  display: block;
  font-size: 18px;
  font-weight: 700;
  color: white;
  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
}

#heatmap-tooltip {
  display: none;
  position: absolute;
  background: rgba(30, 41, 59, 0.95);
  color: white;
  padding: 12px 16px;
  border-radius: 8px;
  font-size: 13px;
  line-height: 1.6;
  pointer-events: none;
  z-index: 1000;
}
```

---

## Step 4: 매매/전세 갭 차트 생성

### 프롬프트

```text
/data:create-viz
강남구의 최근 12개월 매매가와 전세가 추이를 이중 차트로 만들어줘.
- 왼쪽 Y축: 매매가 (억 원), 오른쪽 Y축: 전세가 (억 원)
- 매매가와 전세가 사이 갭 영역을 연한 색상으로 음영 처리
- 전세가율 추이를 별도 라인으로 오버레이
- Chart.js 기반으로 구현하고, 지역 변경 드롭다운도 추가해줘
```

### 이중축 차트 구현

Chart.js의 이중 Y축 기능을 활용하여 매매가와 전세가를 동시에 표시합니다. 두 가격 사이의 갭(Gap)은 투자 수익 잠재력을 판단하는 핵심 지표입니다.

### 예상 JavaScript 코드

```javascript
// 강남구 12개월 시계열 데이터
const timeSeriesData = {
  labels: ['2025.02', '2025.03', '2025.04', '2025.05', '2025.06', '2025.07',
           '2025.08', '2025.09', '2025.10', '2025.11', '2025.12', '2026.01'],
  매매가: [17.2, 17.4, 17.5, 17.6, 17.8, 17.9, 18.0, 18.0, 18.1, 18.1, 18.2, 18.2],
  전세가: [9.2, 9.3, 9.3, 9.4, 9.5, 9.5, 9.6, 9.6, 9.7, 9.7, 9.8, 9.8],
  전세가율: [53.5, 53.4, 53.1, 53.4, 53.4, 53.1, 53.3, 53.3, 53.6, 53.6, 53.8, 53.8]
};

// Chart.js 이중축 차트 생성
const ctx = document.getElementById('gapChart').getContext('2d');

const gapChart = new Chart(ctx, {
  type: 'line',
  data: {
    labels: timeSeriesData.labels,
    datasets: [
      {
        label: '매매가 (억 원)',
        data: timeSeriesData.매매가,
        borderColor: '#EF4444',
        backgroundColor: 'rgba(239, 68, 68, 0.1)',
        borderWidth: 3,
        pointRadius: 4,
        pointHoverRadius: 6,
        fill: false,
        yAxisID: 'y-price',
        tension: 0.3
      },
      {
        label: '전세가 (억 원)',
        data: timeSeriesData.전세가,
        borderColor: '#3B82F6',
        backgroundColor: 'rgba(59, 130, 246, 0.1)',
        borderWidth: 3,
        pointRadius: 4,
        pointHoverRadius: 6,
        fill: '-1',  // 이전 데이터셋과의 사이를 채움 (갭 영역)
        yAxisID: 'y-price',
        tension: 0.3
      },
      {
        label: '전세가율 (%)',
        data: timeSeriesData.전세가율,
        borderColor: '#F59E0B',
        borderWidth: 2,
        borderDash: [6, 3],
        pointRadius: 3,
        fill: false,
        yAxisID: 'y-ratio',
        tension: 0.3
      }
    ]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    interaction: {
      mode: 'index',
      intersect: false
    },
    plugins: {
      title: {
        display: true,
        text: '강남구 매매/전세 추이 및 갭 분석',
        font: { size: 16, weight: 'bold' },
        color: '#1E293B'
      },
      tooltip: {
        callbacks: {
          label: function(context) {
            const label = context.dataset.label;
            const value = context.parsed.y;
            if (label.includes('전세가율')) {
              return `${label}: ${value.toFixed(1)}%`;
            }
            return `${label}: ${value.toFixed(1)}억 원`;
          },
          afterBody: function(tooltipItems) {
            const index = tooltipItems[0].dataIndex;
            const gap = timeSeriesData.매매가[index] - timeSeriesData.전세가[index];
            return `매매-전세 갭: ${gap.toFixed(1)}억 원`;
          }
        }
      },
      legend: {
        position: 'bottom',
        labels: { padding: 20, usePointStyle: true }
      }
    },
    scales: {
      'y-price': {
        type: 'linear',
        position: 'left',
        title: {
          display: true,
          text: '가격 (억 원)',
          font: { size: 13, weight: '600' }
        },
        ticks: {
          callback: function(value) {
            return value.toFixed(1) + '억';
          }
        },
        grid: { color: 'rgba(0, 0, 0, 0.06)' }
      },
      'y-ratio': {
        type: 'linear',
        position: 'right',
        title: {
          display: true,
          text: '전세가율 (%)',
          font: { size: 13, weight: '600' }
        },
        min: 45,
        max: 70,
        ticks: {
          callback: function(value) {
            return value + '%';
          }
        },
        grid: { drawOnChartArea: false }
      }
    }
  }
});
```

### 갭 분석 해석 안내

차트에서 매매가 선(빨간색)과 전세가 선(파란색) 사이의 음영 영역이 **매매-전세 갭**입니다.

- **갭이 좁아지는 구간:** 전세가율이 상승하는 구간으로, 갭투자 리스크가 증가합니다.
- **갭이 넓어지는 구간:** 매매가 상승률이 전세가 상승률보다 높은 구간으로, 매매 시장이 과열될 가능성이 있습니다.
- **전세가율 50% 이하:** 투자 여력이 상대적으로 높은 구간입니다.

---

## Step 5: 인터랙티브 대시보드 통합

### 프롬프트

```text
/data:build-dashboard
지금까지 만든 차트들을 하나의 인터랙티브 HTML 대시보드로 통합해줘.

포함 요소:
1. 상단: 핵심 지표 카드 4개 (평균매매가, 변동률, 거래량, 전세가율)
2. 중앙 좌측: 구별 히트맵 (5x5 그리드)
3. 중앙 우측: 매매/전세 추이 차트 (Chart.js)
4. 하단: 거래 상세 데이터 테이블 (정렬/검색 기능 포함)

기능 요구사항:
- 상단 필터 드롭다운: 지역 선택, 면적대 선택(소형/중형/대형), 기간 선택
- 히트맵 클릭 시 해당 구의 추이 차트로 자동 업데이트
- 테이블 컬럼 클릭 시 정렬
- 반응형 레이아웃 (모바일 대응)
- Chart.js CDN 사용

결과물을 단일 HTML 파일로 만들어줘.
```

### 대시보드 HTML 구조

`data:build-dashboard` 스킬이 생성하는 HTML 파일의 전체 구조는 다음과 같습니다:

```html
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>서울 아파트 시장 분석 대시보드</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>
  <style>
    /* 전역 스타일 */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
      background-color: #F1F5F9;
      color: #1E293B;
    }

    /* 헤더 */
    .dashboard-header {
      background: linear-gradient(135deg, #1E40AF, #3B82F6);
      color: white;
      padding: 24px 32px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .dashboard-title { font-size: 24px; font-weight: 700; }
    .dashboard-date { font-size: 14px; opacity: 0.8; }

    /* 필터 바 */
    .filter-bar {
      background: white;
      padding: 16px 32px;
      display: flex;
      gap: 16px;
      align-items: center;
      border-bottom: 1px solid #E2E8F0;
    }
    .filter-group { display: flex; align-items: center; gap: 8px; }
    .filter-group label { font-size: 13px; font-weight: 600; color: #64748B; }
    .filter-group select {
      padding: 8px 12px;
      border: 1px solid #CBD5E1;
      border-radius: 6px;
      font-size: 14px;
      background: white;
    }

    /* 메인 레이아웃 */
    .dashboard-body { padding: 24px 32px; }

    /* KPI 카드 영역 */
    .kpi-container {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      margin-bottom: 24px;
    }

    /* 차트 영역 */
    .chart-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 24px;
    }
    .chart-card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
    }
    .chart-card h3 {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 16px;
      color: #334155;
    }

    /* 테이블 영역 */
    .table-card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
    }

    /* 반응형 */
    @media (max-width: 1024px) {
      .kpi-container { grid-template-columns: repeat(2, 1fr); }
      .chart-row { grid-template-columns: 1fr; }
    }
    @media (max-width: 640px) {
      .kpi-container { grid-template-columns: 1fr; }
      .dashboard-body { padding: 16px; }
    }
  </style>
</head>
<body>
  <!-- 헤더 -->
  <header class="dashboard-header">
    <div>
      <h1 class="dashboard-title">서울 아파트 시장 분석 대시보드</h1>
      <p class="dashboard-date">데이터 기준: 2026년 1월 | 출처: 국토교통부 실거래가</p>
    </div>
  </header>

  <!-- 필터 바 -->
  <div class="filter-bar">
    <div class="filter-group">
      <label for="filter-gu">지역</label>
      <select id="filter-gu">
        <option value="all">서울 전체</option>
        <option value="강남구">강남구</option>
        <option value="서초구">서초구</option>
        <!-- 25개 구 옵션 -->
      </select>
    </div>
    <div class="filter-group">
      <label for="filter-size">면적대</label>
      <select id="filter-size">
        <option value="all">전체</option>
        <option value="small">소형 (60m2 이하)</option>
        <option value="medium">중형 (60-85m2)</option>
        <option value="large">대형 (85m2 초과)</option>
      </select>
    </div>
    <div class="filter-group">
      <label for="filter-period">기간</label>
      <select id="filter-period">
        <option value="3m">최근 3개월</option>
        <option value="6m">최근 6개월</option>
        <option value="12m" selected>최근 12개월</option>
        <option value="24m">최근 24개월</option>
      </select>
    </div>
  </div>

  <!-- 메인 대시보드 -->
  <main class="dashboard-body">
    <!-- KPI 카드 -->
    <div class="kpi-container" id="kpi-section"></div>

    <!-- 차트 영역 -->
    <div class="chart-row">
      <div class="chart-card">
        <h3>구별 평균 매매가 히트맵</h3>
        <div id="heatmap-container"></div>
        <div id="heatmap-tooltip"></div>
      </div>
      <div class="chart-card">
        <h3>매매/전세 추이 및 갭 분석</h3>
        <div style="height: 400px;">
          <canvas id="gapChart"></canvas>
        </div>
      </div>
    </div>

    <!-- 상세 테이블 -->
    <div class="table-card">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
        <h3 style="font-size: 16px; font-weight: 600; color: #334155;">거래 상세 데이터</h3>
        <input type="text" id="table-search" placeholder="지역명 검색..."
               style="padding: 8px 12px; border: 1px solid #CBD5E1; border-radius: 6px;">
      </div>
      <table id="data-table">
        <thead>
          <tr>
            <th data-sort="gu">지역</th>
            <th data-sort="price">평균 매매가</th>
            <th data-sort="jeonse">평균 전세가</th>
            <th data-sort="ratio">전세가율</th>
            <th data-sort="volume">거래량</th>
            <th data-sort="change">변동률</th>
          </tr>
        </thead>
        <tbody id="table-body"></tbody>
      </table>
    </div>
  </main>

  <script>
    // === 데이터 및 차트 초기화 스크립트 ===
    // (Step 1-4의 코드가 여기에 통합됩니다)
  </script>
</body>
</html>
```

### 파일 저장 위치

`data:build-dashboard` 스킬은 완성된 HTML 파일을 작업 디렉토리에 저장합니다:

```text
~/realestate-dashboard/
  dashboard.html          <- 메인 대시보드 파일
  data/
    seoul_district.json   <- 구별 데이터
    timeseries.json       <- 시계열 데이터
```

---

## Step 6: 필터링 및 상호작용 기능

대시보드의 핵심은 사용자가 원하는 조건으로 데이터를 탐색할 수 있는 인터랙티브 기능입니다.

### 6-1. 지역 선택 시 차트 자동 업데이트

히트맵에서 특정 구를 클릭하면 우측 추이 차트가 해당 구의 데이터로 자동 업데이트됩니다.

```javascript
// 히트맵 셀 클릭 이벤트
function onHeatmapCellClick(gu) {
  // 드롭다운 필터도 동기화
  document.getElementById('filter-gu').value = gu;

  // 해당 구의 시계열 데이터 로드
  const guData = getTimeSeriesData(gu);

  // 추이 차트 업데이트
  gapChart.data.datasets[0].data = guData.매매가;
  gapChart.data.datasets[1].data = guData.전세가;
  gapChart.data.datasets[2].data = guData.전세가율;
  gapChart.options.plugins.title.text = `${gu} 매매/전세 추이 및 갭 분석`;
  gapChart.update('active');

  // KPI 카드 업데이트
  updateKPICards(gu);

  // 테이블 필터링
  filterTable(gu);

  // 히트맵에서 선택된 셀 강조
  highlightHeatmapCell(gu);
}

// 히트맵 셀 강조 표시
function highlightHeatmapCell(selectedGu) {
  document.querySelectorAll('.heatmap-cell').forEach(cell => {
    const isSelected = cell.dataset.gu === selectedGu;
    cell.style.outline = isSelected ? '3px solid #1E40AF' : 'none';
    cell.style.outlineOffset = isSelected ? '2px' : '0';
  });
}
```

### 6-2. 기간 범위 슬라이더

드롭다운 대신 범위 슬라이더를 사용하면 더 직관적인 기간 선택이 가능합니다.

```javascript
// 기간 필터 변경 이벤트
document.getElementById('filter-period').addEventListener('change', function() {
  const period = this.value;
  const monthsMap = { '3m': 3, '6m': 6, '12m': 12, '24m': 24 };
  const months = monthsMap[period];

  // 시계열 데이터를 선택된 기간만큼 슬라이스
  const selectedGu = document.getElementById('filter-gu').value;
  const fullData = getTimeSeriesData(selectedGu);

  const slicedLabels = fullData.labels.slice(-months);
  const slicedSale = fullData.매매가.slice(-months);
  const slicedJeonse = fullData.전세가.slice(-months);
  const slicedRatio = fullData.전세가율.slice(-months);

  gapChart.data.labels = slicedLabels;
  gapChart.data.datasets[0].data = slicedSale;
  gapChart.data.datasets[1].data = slicedJeonse;
  gapChart.data.datasets[2].data = slicedRatio;
  gapChart.update('active');
});
```

### 6-3. 면적대 필터

```javascript
// 면적대 필터 변경 이벤트
document.getElementById('filter-size').addEventListener('change', function() {
  const sizeCategory = this.value;

  // 면적대별 데이터 재계산
  // 소형: 60m2 이하, 중형: 60-85m2, 대형: 85m2 초과
  const filteredData = filterBySize(allData, sizeCategory);

  // 모든 차트 및 테이블 업데이트
  updateAllComponents(filteredData);
});
```

### 6-4. 테이블 정렬 및 검색

```javascript
// 테이블 헤더 클릭으로 정렬
let currentSort = { column: 'price', direction: 'desc' };

document.querySelectorAll('#data-table th').forEach(th => {
  th.addEventListener('click', function() {
    const column = this.dataset.sort;
    const direction = (currentSort.column === column && currentSort.direction === 'desc')
      ? 'asc'
      : 'desc';

    currentSort = { column, direction };
    sortAndRenderTable(column, direction);

    // 정렬 표시 아이콘 업데이트
    document.querySelectorAll('#data-table th').forEach(h => {
      h.classList.remove('sort-asc', 'sort-desc');
    });
    this.classList.add(`sort-${direction}`);
  });
});

// 검색 기능
document.getElementById('table-search').addEventListener('input', function() {
  const query = this.value.trim().toLowerCase();
  const rows = document.querySelectorAll('#table-body tr');

  rows.forEach(row => {
    const guName = row.cells[0].textContent.toLowerCase();
    row.style.display = guName.includes(query) ? '' : 'none';
  });
});

// 테이블 렌더링 함수
function renderTable(data) {
  const tbody = document.getElementById('table-body');
  tbody.innerHTML = '';

  data.forEach(item => {
    const changeClass = item.change > 0 ? 'positive' : item.change < 0 ? 'negative' : '';
    const changeSign = item.change > 0 ? '+' : '';

    const row = document.createElement('tr');
    row.innerHTML = `
      <td><strong>${item.gu}</strong></td>
      <td>${(item.price).toFixed(1)}억 원</td>
      <td>${(item.jeonse).toFixed(1)}억 원</td>
      <td>${item.ratio.toFixed(1)}%</td>
      <td>${item.volume.toLocaleString()}건</td>
      <td class="${changeClass}">${changeSign}${item.change.toFixed(1)}%</td>
    `;
    tbody.appendChild(row);
  });
}
```

---

## Step 7: 대시보드 배포 및 공유

### 7-1. HTML 파일로 로컬 저장

`data:build-dashboard` 스킬이 생성한 대시보드는 단일 HTML 파일로 저장됩니다. 모든 스타일과 스크립트가 인라인으로 포함되어 있어 별도의 서버 없이도 동작합니다.

```text
> 대시보드를 ~/realestate-dashboard/dashboard.html 파일로 저장해줘
```

### 7-2. 브라우저에서 열기

저장된 HTML 파일을 브라우저에서 바로 열어 확인합니다:

```bash
# macOS
open ~/realestate-dashboard/dashboard.html

# Windows
start ~/realestate-dashboard/dashboard.html

# Linux
xdg-open ~/realestate-dashboard/dashboard.html
```

### 7-3. GitHub Pages로 정적 호스팅

대시보드를 팀원이나 고객과 공유하고 싶다면 GitHub Pages를 활용할 수 있습니다.

**단계별 안내:**

1. GitHub 저장소 생성:

```bash
cd ~/realestate-dashboard
git init
git add dashboard.html
git commit -m "feat: 부동산 분석 대시보드 초기 버전"
git remote add origin https://github.com/<사용자명>/realestate-dashboard.git
git push -u origin main
```

2. GitHub Pages 활성화:
   - 저장소 Settings > Pages 이동
   - Source: "Deploy from a branch" 선택
   - Branch: `main` / `/ (root)` 선택
   - Save 클릭

3. 배포 URL 확인:
   - `https://<사용자명>.github.io/realestate-dashboard/dashboard.html`
   - 배포까지 1-2분 소요될 수 있습니다.

### 7-4. 자동 업데이트 구성

정기적으로 데이터를 갱신하려면 Claude Code를 활용한 자동화 스크립트를 구성할 수 있습니다:

```text
매월 1일에 서울 아파트 최신 데이터를 수집해서 대시보드를 업데이트해줘.
업데이트된 HTML을 GitHub에 자동 커밋해줘.
```

---

## 실전 응용

### 응용 1: 투자 후보 스크리닝 대시보드

특정 조건을 만족하는 투자 후보 지역이나 단지를 자동으로 선별하는 대시보드를 구축합니다.

**프롬프트:**

```text
투자 후보 스크리닝 대시보드를 만들어줘.
선별 조건:
- 전세가율 60% 이상
- 최근 3개월 매매가 상승률 1% 이상
- 월간 거래량 200건 이상
조건을 만족하는 구를 하이라이트하고, 조건별 슬라이더로 실시간 필터링 가능하게 해줘.
```

**예상 결과:**

조건을 만족하는 구가 녹색으로 강조 표시되며, 슬라이더를 조절하면 실시간으로 결과가 변경됩니다. 위 샘플 데이터 기준으로 다음 구가 선별됩니다:

| 구 | 전세가율 | 3개월 상승률 | 거래량 | 판정 |
|---|---|---|---|---|
| 강서구 | 61.5% | +0.5% | 345건 | 상승률 미달 |
| 노원구 | 63.8% | +0.1% | 287건 | 상승률 미달 |
| 양천구 | 60.0% | +1.3% | 234건 | **적합** |
| 구로구 | 62.5% | +0.4% | 213건 | 상승률 미달 |

조건 슬라이더를 조정하면 더 많은 후보를 확인할 수 있습니다.

### 응용 2: 시장 모니터링 대시보드

주간 또는 월간 시장 변화를 추적하는 모니터링 대시보드입니다.

**프롬프트:**

```text
주간 시장 모니터링 대시보드를 만들어줘.
포함 요소:
- 주간 거래량 변동 바 차트
- 구별 가격 변동 Top 5 / Bottom 5
- 전세가율 변동 추이
- 시장 과열/냉각 신호 표시 (거래량 급증/급감 감지)
```

**핵심 시각화: 구별 가격 변동 Top 5 / Bottom 5 가로 막대 차트**

```javascript
// 가격 변동 상위/하위 5개 구
const sortedByChange = [...heatmapData].sort((a, b) => b.change - a.change);
const top5 = sortedByChange.slice(0, 5);
const bottom5 = sortedByChange.slice(-5).reverse();

const changeCtx = document.getElementById('changeChart').getContext('2d');
const changeChart = new Chart(changeCtx, {
  type: 'bar',
  data: {
    labels: [...top5.map(d => d.gu), ...bottom5.map(d => d.gu)],
    datasets: [{
      label: '전월 대비 변동률 (%)',
      data: [...top5.map(d => d.change), ...bottom5.map(d => d.change)],
      backgroundColor: [...top5.map(d => d.change), ...bottom5.map(d => d.change)].map(v =>
        v >= 0 ? 'rgba(239, 68, 68, 0.7)' : 'rgba(59, 130, 246, 0.7)'
      ),
      borderColor: [...top5.map(d => d.change), ...bottom5.map(d => d.change)].map(v =>
        v >= 0 ? '#EF4444' : '#3B82F6'
      ),
      borderWidth: 1
    }]
  },
  options: {
    indexAxis: 'y',
    responsive: true,
    plugins: {
      title: {
        display: true,
        text: '구별 가격 변동률 (상위 5 / 하위 5)',
        font: { size: 15, weight: 'bold' }
      }
    },
    scales: {
      x: {
        ticks: {
          callback: function(value) {
            return (value > 0 ? '+' : '') + value + '%';
          }
        }
      }
    }
  }
});
```

### 응용 3: 포트폴리오 현황 대시보드

보유 부동산 자산의 현재가, 수익률, 대출 현황 등을 종합적으로 표시하는 개인 포트폴리오 대시보드입니다.

**프롬프트:**

```text
부동산 포트폴리오 현황 대시보드를 만들어줘.

보유 자산:
1. 강남구 래미안 블레스티지 84m2 - 매입가 16억, 대출 8억
2. 송파구 헬리오시티 59m2 - 매입가 12억, 대출 6억
3. 마포구 래미안 푸르지오 84m2 - 매입가 10억, 대출 5억

포함 요소:
- 총 자산 가치 / 총 대출 / 순자산 카드
- 개별 자산 수익률 도넛 차트
- 자산별 현재 시세 vs 매입가 비교 차트
- LTV(담보인정비율) 현황
```

**예상 KPI 카드:**

| 지표 | 값 | 계산 방식 |
|------|-----|----------|
| 총 자산 현재가 | 42.2억 원 | 18.2 + 14.2 + 11.2 (현재 시세 합계) |
| 총 매입가 | 38.0억 원 | 16 + 12 + 10 |
| 총 평가 수익 | +4.2억 원 | 현재가 - 매입가 |
| 평균 수익률 | +11.1% | (4.2 / 38.0) x 100 |
| 총 대출 잔액 | 19.0억 원 | 8 + 6 + 5 |
| 순자산 | 23.2억 원 | 총 자산 - 총 대출 |
| 평균 LTV | 45.0% | (19 / 42.2) x 100 |

---

## 시각화 팁

대시보드의 가독성과 전문성을 높이기 위한 실전 팁입니다.

### 색상 선택 가이드

한국 부동산 시장에서 통용되는 색상 관례를 따릅니다:

| 용도 | 색상 | 코드 | 설명 |
|------|------|------|------|
| 기본 테마 | 파란색 계열 | `#3B82F6` | 부동산/금융 대시보드의 기본 색상 |
| 가격 상승 | 빨간색 | `#EF4444` | 한국 주식/부동산 관례 (상승 = 빨간색) |
| 가격 하락 | 파란색 | `#3B82F6` | 한국 주식/부동산 관례 (하락 = 파란색) |
| 보합/중립 | 회색 | `#94A3B8` | 변동 없음 |
| 경고 신호 | 주황색 | `#F59E0B` | 과열/주의 구간 |
| 긍정 신호 | 녹색 | `#10B981` | 거래량 증가, 투자 적합 조건 |

> **주의:** 글로벌 표준(상승=녹색, 하락=빨간색)과 한국 관례가 반대입니다. 한국 사용자 대상 대시보드에서는 반드시 한국 관례를 따라야 합니다.

### 숫자 포맷 규칙

부동산 데이터의 가독성을 위한 숫자 표시 규칙입니다:

```javascript
// 가격 포맷 함수 (만원 -> 억 원 변환)
function formatPrice(manwon) {
  if (manwon >= 10000) {
    const eok = Math.floor(manwon / 10000);
    const remainder = manwon % 10000;
    if (remainder === 0) {
      return `${eok}억 원`;
    }
    return `${eok}억 ${remainder.toLocaleString()}만 원`;
  }
  return `${manwon.toLocaleString()}만 원`;
}

// 사용 예시
formatPrice(182000);  // "18억 2,000만 원"
formatPrice(50000);   // "5억 원"
formatPrice(8500);    // "8,500만 원"

// 변동률 포맷 함수
function formatChange(value) {
  const sign = value > 0 ? '+' : '';
  return `${sign}${value.toFixed(1)}%`;
}

// 거래량 포맷 함수
function formatVolume(count) {
  return `${count.toLocaleString()}건`;
}
```

### 반응형 디자인 체크리스트

모바일과 태블릿에서도 대시보드가 정상적으로 표시되도록 합니다:

- **1024px 이상 (데스크톱):** 4열 KPI 카드, 2열 차트 레이아웃
- **768px~1024px (태블릿):** 2열 KPI 카드, 1열 차트 레이아웃
- **768px 미만 (모바일):** 1열 전체, 차트 높이 자동 조정, 테이블 가로 스크롤

```css
/* 태블릿 대응 */
@media (max-width: 1024px) {
  .kpi-container { grid-template-columns: repeat(2, 1fr); }
  .chart-row { grid-template-columns: 1fr; }
  .filter-bar { flex-wrap: wrap; }
}

/* 모바일 대응 */
@media (max-width: 640px) {
  .kpi-container { grid-template-columns: 1fr; }
  .dashboard-header { padding: 16px; }
  .dashboard-body { padding: 12px; }
  .dashboard-title { font-size: 18px; }
  .table-card { overflow-x: auto; }
}
```

### 차트 성능 최적화 팁

대량의 데이터를 다룰 때 차트 렌더링 성능을 유지하기 위한 팁입니다:

1. **데이터 포인트 제한:** 시계열 차트는 최대 100개 데이터 포인트까지만 표시합니다.
2. **애니메이션 최소화:** 필터 변경 시 `chart.update('none')`으로 애니메이션을 생략합니다.
3. **지연 로딩:** 스크롤 위치에 따라 보이는 차트만 렌더링합니다.
4. **디바운스 적용:** 필터 입력에 200ms 디바운스를 적용하여 불필요한 재렌더링을 방지합니다.

```javascript
// 디바운스 유틸리티
function debounce(func, delay) {
  let timeoutId;
  return function(...args) {
    clearTimeout(timeoutId);
    timeoutId = setTimeout(() => func.apply(this, args), delay);
  };
}

// 검색 입력에 디바운스 적용
const searchInput = document.getElementById('table-search');
searchInput.addEventListener('input', debounce(function() {
  filterTable(this.value);
}, 200));
```

---

## 자주 발생하는 문제와 해결 방법

### 문제 1: 차트가 렌더링되지 않음

**원인:** Chart.js CDN 로드 실패 또는 canvas 요소 크기 미설정

**해결:**

```html
<!-- CDN 로드 확인 -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>

<!-- canvas 부모 요소에 명시적 높이 설정 -->
<div style="position: relative; height: 400px;">
  <canvas id="gapChart"></canvas>
</div>
```

### 문제 2: 숫자가 깨져서 표시됨

**원인:** 만원 단위와 억원 단위 혼용

**해결:** 데이터 수집 단계에서 단위를 통일하고, 표시 단계에서만 변환합니다.

```javascript
// 데이터는 항상 만원 단위로 저장
const rawPrice = 182000; // 만원

// 표시할 때만 억원으로 변환
const displayPrice = formatPrice(rawPrice); // "18억 2,000만 원"
```

### 문제 3: 필터 변경 시 차트가 업데이트되지 않음

**원인:** Chart.js의 `update()` 메서드 누락

**해결:** 데이터 변경 후 반드시 `chart.update()`를 호출합니다.

```javascript
// 데이터 변경
gapChart.data.datasets[0].data = newData;

// 반드시 update() 호출
gapChart.update('active'); // 'active'는 부드러운 전환 애니메이션 적용
```

---

## 완성된 대시보드 확인 체크리스트

최종 대시보드가 올바르게 동작하는지 다음 항목을 점검합니다:

- [ ] KPI 카드 4개가 정상적으로 표시되는가
- [ ] 히트맵에 25개 구가 모두 표시되는가
- [ ] 히트맵 셀 클릭 시 추이 차트가 업데이트되는가
- [ ] 지역 드롭다운 변경 시 모든 차트가 연동되는가
- [ ] 면적대 필터가 정상 동작하는가
- [ ] 기간 필터가 정상 동작하는가
- [ ] 테이블 정렬(오름차순/내림차순)이 동작하는가
- [ ] 테이블 검색이 동작하는가
- [ ] 모바일 화면에서 레이아웃이 깨지지 않는가
- [ ] 숫자 포맷이 올바른가 (억 단위, 천 단위 콤마)
- [ ] 색상 관례가 올바른가 (상승=빨간색, 하락=파란색)

---

## 다음 단계

이 튜터리얼에서 구축한 대시보드를 기반으로, 더 고급 분석 기능을 추가해 볼 수 있습니다:

- [튜터리얼 6: 지역비교 분석 리포트 자동생성](./튜터리얼6_지역비교_분석_리포트_자동생성.md) - 여러 지역을 비교 분석하는 리포트를 자동으로 생성합니다.
- [튜터리얼 7: 투자 포트폴리오 관리 자동화](./튜터리얼7_투자_포트폴리오_관리_자동화.md) - 보유 자산의 현황 파악부터 리밸런싱 알림까지 자동화합니다.
